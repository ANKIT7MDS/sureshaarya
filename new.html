<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Karyakram Dashboard ‚Äì FIXED</title>

<!-- LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

<style>
body{margin:0;background:#0b0c10;color:#fff;font-family:Arial}
.slide{
  width:1200px;height:800px;
  background:#0b0c10;
  padding:30px;
  display:flex;
  gap:20px;
}
.info{
  flex:1;
  background:#1f2833;
  padding:30px;
  border-radius:15px;
}
.photos{
  flex:1;
  display:grid;
  grid-template-columns:1fr 1fr;
  grid-template-rows:1fr 1fr;
  gap:15px;
}
.photo{
  border:2px solid #45a29e;
  border-radius:10px;
  overflow:hidden;
  background:#000;
}
.photo img{
  width:100%;
  height:100%;
  object-fit:cover;
}
button{
  padding:10px 20px;
  margin:10px;
  cursor:pointer;
}
</style>
</head>

<body>

<button onclick="downloadSlide()">‚¨áÔ∏è Download Image</button>
<button onclick="downloadPDF()">‚¨áÔ∏è Download PDF</button>
<button onclick="downloadPPT()">‚¨áÔ∏è Download PPT</button>

<div id="slide" class="slide">
  <div class="info">
    <h1 id="event">‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§æ‡§Æ</h1>
    <p>üìÖ 12-01-2026</p>
    <p>üìç Jaipur</p>
    <p>üë• 1200</p>
    <p>üé§ Guest Name</p>
  </div>

  <div class="photos">
    <div class="photo"><img crossorigin="anonymous" src="" id="img1"></div>
    <div class="photo"><img crossorigin="anonymous" src="" id="img2"></div>
    <div class="photo"><img crossorigin="anonymous" src="" id="img3"></div>
    <div class="photo"><img crossorigin="anonymous" src="" id="img4"></div>
  </div>
</div>

<script>
/* üîπ GOOGLE DRIVE FILE IDS */
const images = [
 "1wyr0gt061UT5IVxT1JBYUEUJw1GYcBpzxDKEQmvcXXY",
 "1wyr0gt061UT5IVxT1JBYUEUJw1GYcBpzxDKEQmvcXXY",
 "1wyr0gt061UT5IVxT1JBYUEUJw1GYcBpzxDKEQmvcXXY",
 "1wyr0gt061UT5IVxT1JBYUEUJw1GYcBpzxDKEQmvcXXY"
];

/* üîπ LOAD DRIVE IMAGES CORRECT WAY */
images.forEach((id,i)=>{
  document.getElementById("img"+(i+1)).src =
   `https://lh3.googleusercontent.com/d/${id}=w1200`;
});

/* üîπ WAIT FOR IMAGES */
function waitForImages(el){
  const imgs = el.querySelectorAll("img");
  return Promise.all([...imgs].map(img=>{
    if(img.complete) return Promise.resolve();
    return new Promise(res=>img.onload=img.onerror=res);
  }));
}

/* üîπ IMAGE DOWNLOAD */
async function downloadSlide(){
  const slide=document.getElementById("slide");
  await waitForImages(slide);

  const canvas=await html2canvas(slide,{
    backgroundColor:"#0b0c10",
    scale:2,
    useCORS:true,
    allowTaint:false
  });

  const link=document.createElement("a");
  link.download="slide.png";
  link.href=canvas.toDataURL("image/png");
  link.click();
}

/* üîπ PDF DOWNLOAD */
async function downloadPDF(){
  const slide=document.getElementById("slide");
  await waitForImages(slide);

  html2pdf().set({
    margin:0,
    filename:"slide.pdf",
    html2canvas:{
      scale:2,
      useCORS:true,
      allowTaint:false,
      backgroundColor:"#0b0c10"
    },
    jsPDF:{unit:"px",format:[1200,800],orientation:"landscape"}
  }).from(slide).save();
}

/* üîπ PPT DOWNLOAD */
async function downloadPPT(){
  const ppt=new PptxGenJS();
  ppt.layout="LAYOUT_WIDE";
  const slide=ppt.addSlide();

  slide.addText("‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§®‡§æ‡§Æ",{x:0.5,y:0.5,fontSize:24,color:"66fcf1"});

  for(let i=0;i<4;i++){
    slide.addImage({
      path:`https://lh3.googleusercontent.com/d/${images[i]}=w1200`,
      x:(i%2?5.5:3),
      y:(i<2?1.5:3.5),
      w:2.2,h:1.6
    });
  }

  ppt.writeFile({fileName:"slide.pptx"});
}
</script>

</body>
</html>
